<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NATURE'S HARVEST | Organic Food Market</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap');
        
        body {
            font-family: 'Montserrat', sans-serif;
            scroll-behavior: smooth;
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, #f0f7f0 0%, #c8e6c9 100%);
        }
        
        .hero-title {
            font-family: 'Playfair Display', serif;
        }
        
        .product-card:hover .product-overlay {
            opacity: 1;
            transform: translateY(0);
        }
        
        .product-overlay {
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(10px);
            cursor: pointer;
        }
        
        .cart-item-enter {
            opacity: 0;
            transform: translateX(-20px);
        }
        
        .cart-item-enter-active {
            opacity: 1;
            transform: translateX(0);
            transition: all 0.3s ease;
        }
        
        .cart-item-exit {
            opacity: 1;
            transform: translateX(0);
        }
        
        .cart-item-exit-active {
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.3s ease;
        }
        
        .nav-link::after {
            content: '';
            display: block;
            width: 0;
            height: 2px;
            background: #4CAF50;
            transition: width 0.3s;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }

        /* Cart Sidebar Transitions */
        #cart-panel {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }
        #cart-sidebar.cart-sidebar-open #cart-panel {
            transform: translateX(0);
        }

        #cart-overlay {
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        #cart-sidebar.cart-sidebar-open #cart-overlay {
            opacity: 1;
        }

        /* Hero Section Animation */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeInUp { animation: fadeInUp 0.8s ease-out forwards; }
        .hero-text-h1, .hero-text-p, .hero-button-shop { opacity: 0; }
        .hero-text-h1 { animation-delay: 0.2s; }
        .hero-text-p { animation-delay: 0.4s; }
        .hero-button-shop { animation-delay: 0.6s; }
        
        /* Scroll-based Fade-in Animations */
        .fade-in-on-scroll {
            opacity: 0;
            transition: opacity 0.8s ease-out;
        }
        .fade-in-on-scroll.is-visible {
            opacity: 1;
        }

        /* Mobile Menu & Search Bar Transitions */
        #mobile-menu, #search-bar {
            transform: translateY(-20px);
            opacity: 0;
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            pointer-events: none;
        }
        #mobile-menu.is-open, #search-bar.is-open {
            transform: translateY(0);
            opacity: 1;
            pointer-events: auto;
        }
        
        /* Organic elements */
        .leaf-decoration {
            position: absolute;
            width: 120px;
            height: 120px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%234CAF50" d="M50,10 C30,10 10,30 10,50 C10,70 30,90 50,90 C70,90 90,70 90,50 C90,30 70,10 50,10 Z M50,30 C60,30 70,40 70,50 C70,60 60,70 50,70 C40,70 30,60 30,50 C30,40 40,30 50,30 Z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            opacity: 0.1;
            z-index: 0;
        }
        
        .organic-badge {
            background-color: #4CAF50;
            color: white;
            border-radius: 20px;
            padding: 2px 10px;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-block;
            margin-left: 8px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm fixed w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="#" class="text-xl font-bold text-green-700">NATURE'S HARVEST</a>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#home" class="nav-link text-gray-700 hover:text-green-700 px-1">Home</a>
                    <a href="#shop" class="nav-link text-gray-700 hover:text-green-700 px-1">Shop</a>
                    <a href="#collections" class="nav-link text-gray-700 hover:text-green-700 px-1">Categories</a>
                    <a href="#about" class="nav-link text-gray-700 hover:text-green-700 px-1">About</a>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="search-btn" class="text-gray-700 hover:text-green-700">
                        <i class="fas fa-search"></i>
                    </button>
                    <button id="cart-btn" class="text-gray-700 hover:text-green-700 relative">
                        <i class="fas fa-shopping-basket"></i>
                        <span id="cart-count" class="absolute -top-2 -right-2 bg-green-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                    </button>
                    <button class="md:hidden text-gray-700 hover:text-green-700" id="mobile-menu-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div class="md:hidden bg-white shadow-lg" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#home" class="block px-3 py-2 text-gray-700 hover:text-green-700 rounded-md">Home</a>
                <a href="#shop" class="block px-3 py-2 text-gray-700 hover:text-green-700 rounded-md">Shop</a>
                <a href="#collections" class="block px-3 py-2 text-gray-700 hover:text-green-700 rounded-md">Categories</a>
                <a href="#about" class="block px-3 py-2 text-gray-700 hover:text-green-700 rounded-md">About</a>
            </div>
        </div>
        
        <!-- Search Bar -->
        <div class="bg-white py-2 px-4 shadow-md" id="search-bar">
            <div class="max-w-7xl mx-auto flex">
                <input type="text" placeholder="Search for organic products..." class="flex-1 border-b border-gray-300 focus:border-green-600 focus:outline-none py-2 px-2 text-sm">
                <button class="ml-2 text-gray-700 hover:text-green-700">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-gradient pt-24 pb-16 md:pt-32 md:pb-24 overflow-hidden">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
            <div class="leaf-decoration" style="top: -30px; left: -30px;"></div>
            <div class="leaf-decoration" style="bottom: -30px; right: -30px; transform: rotate(180deg);"></div>
            
            <div class="md:flex items-center relative z-10">
                <div class="md:w-1/2 mb-10 md:mb-0">
                    <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-green-800 mb-6 animate-fadeInUp hero-text-h1 hero-title">Fresh From Nature</h1>
                    <p class="text-lg text-gray-700 mb-8 animate-fadeInUp hero-text-p">Discover our premium selection of organic, farm-fresh foods designed for health-conscious individuals who value quality and sustainability.</p>
                    <a href="#shop" class="bg-green-600 text-white px-8 py-3 rounded-md hover:bg-green-700 transition duration-300 inline-block animate-fadeInUp hero-button-shop">Shop Now</a>
                </div>
                <div class="md:w-1/2 flex justify-center animate-fadeInUp" style="animation-delay: 0.8s; opacity:0;">
                    <div class="relative w-full max-w-md">
                        <img src="https://images.unsplash.com/photo-1542838132-92c53300491e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1374&q=80" alt="Fresh Organic Food" class="rounded-lg shadow-xl w-full">
                        <div class="absolute -bottom-6 -right-6 bg-white p-4 rounded-lg shadow-lg hidden md:block">
                            <p class="text-sm font-medium">Seasonal Specials</p>
                            <p class="text-xs text-gray-500">Farm to Table</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Categories -->
    <section class="py-12 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-2xl font-bold text-center mb-12 fade-in-on-scroll">Shop By Category</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                <a href="#" class="group relative overflow-hidden rounded-lg fade-in-on-scroll" style="animation-delay: 0.1s;">
                    <img src="https://images.unsplash.com/photo-1518843875459-f738682238a6?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1442&q=80" alt="Fresh Produce" class="w-full h-48 md:h-64 object-cover transition duration-300 group-hover:scale-105">
                    <div class="absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center">
                        <h3 class="text-white font-medium text-lg">Fresh Produce</h3>
                    </div>
                </a>
                <a href="#" class="group relative overflow-hidden rounded-lg fade-in-on-scroll" style="animation-delay: 0.2s;">
                    <img src="https://images.unsplash.com/photo-1550583724-b2692b85b150?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1374&q=80" alt="Dairy & Eggs" class="w-full h-48 md:h-64 object-cover transition duration-300 group-hover:scale-105">
                    <div class="absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center">
                        <h3 class="text-white font-medium text-lg">Dairy & Eggs</h3>
                    </div>
                </a>
                <a href="#" class="group relative overflow-hidden rounded-lg fade-in-on-scroll" style="animation-delay: 0.3s;">
                    <img src="https://images.unsplash.com/photo-1509440159596-0249088772ff?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1472&q=80" alt="Bakery" class="w-full h-48 md:h-64 object-cover transition duration-300 group-hover:scale-105">
                    <div class="absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center">
                        <h3 class="text-white font-medium text-lg">Bakery</h3>
                    </div>
                </a>
                <a href="#" class="group relative overflow-hidden rounded-lg fade-in-on-scroll" style="animation-delay: 0.4s;">
                    <img src="https://images.unsplash.com/photo-1505576399279-565b52d4ac71?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80" alt="Pantry Staples" class="w-full h-48 md:h-64 object-cover transition duration-300 group-hover:scale-105">
                    <div class="absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center">
                        <h3 class="text-white font-medium text-lg">Pantry Staples</h3>
                    </div>
                </a>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="shop" class="py-12 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center mb-8 fade-in-on-scroll">
                <h2 class="text-2xl font-bold text-green-800">Our Products</h2>
                <div class="flex space-x-2">
                    <button class="px-4 py-2 border border-green-300 rounded-md text-sm font-medium hover:bg-green-50">All</button>
                    <button class="px-4 py-2 border border-green-300 rounded-md text-sm font-medium hover:bg-green-50">Organic</button>
                    <button class="px-4 py-2 border border-green-300 rounded-md text-sm font-medium hover:bg-green-50">Local</button>
                    <button class="px-4 py-2 border border-green-300 rounded-md text-sm font-medium hover:bg-green-50">Seasonal</button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8" id="products-container">
                <!-- Products will be loaded here by JavaScript -->
            </div>
            
            <div class="mt-12 text-center">
                <button class="border border-green-600 text-green-600 px-8 py-3 rounded-md hover:bg-green-600 hover:text-white transition duration-300">
                    View All Products
                </button>
            </div>
        </div>
    </section>

    <!-- Collections Section (now Categories) -->
    <section id="collections" class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-2xl font-bold text-center mb-12 text-green-800">Our Categories</h2>
            
            <div class="grid md:grid-cols-2 gap-8 mb-12">
                <div class="relative overflow-hidden rounded-lg h-96">
                    <img src="https://images.unsplash.com/photo-1542838132-92c53300491e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1374&q=80" alt="Organic Produce" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-gradient-to-t from-green-900 via-transparent to-transparent flex items-end p-8">
                        <div>
                            <h3 class="text-white text-2xl font-bold mb-2">Organic Produce</h3>
                            <p class="text-white mb-4">Fresh from local farms, grown without synthetic pesticides</p>
                            <a href="#" class="text-white border-b border-white pb-1">Explore Category</a>
                        </div>
                    </div>
                </div>
                
                <div class="relative overflow-hidden rounded-lg h-96">
                    <img src="https://images.unsplash.com/photo-1550583724-b2692b85b150?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1374&q=80" alt="Dairy & Eggs" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-gradient-to-t from-green-900 via-transparent to-transparent flex items-end p-8">
                        <div>
                            <h3 class="text-white text-2xl font-bold mb-2">Dairy & Eggs</h3>
                            <p class="text-white mb-4">From pasture-raised, hormone-free animals</p>
                            <a href="#" class="text-white border-b border-white pb-1">Explore Category</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="relative overflow-hidden rounded-lg h-96">
                <img src="https://images.unsplash.com/photo-1509440159596-0249088772ff?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1472&q=80" alt="Fresh Bakery" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-r from-green-900 via-transparent to-transparent flex items-center p-8 md:p-16">
                    <div class="md:w-1/2">
                        <h3 class="text-white text-3xl font-bold mb-4">Fresh Bakery</h3>
                        <p class="text-white mb-6">Artisan breads and pastries made with organic, locally-sourced ingredients. Baked fresh daily with traditional methods.</p>
                        <a href="#" class="bg-white text-green-800 px-8 py-3 rounded-md hover:bg-gray-100 transition duration-300 inline-block">Shop Now</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="py-16 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="md:flex items-center">
                <div class="md:w-1/2 mb-10 md:mb-0 md:pr-10">
                    <h2 class="text-3xl font-bold mb-6 text-green-800">Our Story</h2>
                    <p class="text-gray-700 mb-6">Founded in 2010, NATURE'S HARVEST began as a small farmers' market stand with a big vision: to connect health-conscious consumers with the highest quality organic foods.</p>
                    <p class="text-gray-700 mb-6">We believe in sustainable agriculture that nourishes both people and the planet. Each product is carefully selected from trusted local producers who share our values.</p>
                    <p class="text-gray-700 mb-8">Our mission is to make healthy, organic eating accessible while supporting local farmers and sustainable practices.</p>
                    <a href="#" class="border border-green-600 text-green-600 px-8 py-3 rounded-md hover:bg-green-600 hover:text-white transition duration-300 inline-block">Learn More</a>
                </div>
                <div class="md:w-1/2">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="relative overflow-hidden rounded-lg h-48">
                            <img src="https://images.unsplash.com/photo-1464226184884-fa280b87c399?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80" alt="Our Farmers" class="w-full h-full object-cover">
                        </div>
                        <div class="relative overflow-hidden rounded-lg h-48">
                            <img src="https://images.unsplash.com/photo-1606787366850-de6330128bfc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80" alt="Our Ingredients" class="w-full h-full object-cover">
                        </div>
                        <div class="relative overflow-hidden rounded-lg h-48">
                            <img src="https://images.unsplash.com/photo-1606787366850-de6330128bfc?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80" alt="Our Process" class="w-full h-full object-cover">
                        </div>
                        <div class="relative overflow-hidden rounded-lg h-48">
                            <img src="https://images.unsplash.com/photo-1550583724-b2692b85b150?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1374&q=80" alt="Our Store" class="w-full h-full object-cover">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials -->
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-2xl font-bold text-center mb-12 text-green-800 fade-in-on-scroll">What Our Customers Say</h2>
            
            <div class="grid md:grid-cols-3 gap-8">
                <div class="bg-green-50 p-6 rounded-lg fade-in-on-scroll">
                    <div class="flex items-center mb-4">
                        <div class="text-yellow-400">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <p class="text-gray-700 mb-4">"The quality of NATURE'S HARVEST produce is unmatched. I can taste the difference in every bite - so fresh and flavorful!"</p>
                    <div class="flex items-center">
                        <img src="https://randomuser.me/api/portraits/women/44.jpg" alt="Sarah J." class="w-10 h-10 rounded-full mr-3">
                        <div>
                            <p class="font-medium">Sarah J.</p>
                            <p class="text-sm text-gray-500">Customer since 2015</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-green-50 p-6 rounded-lg fade-in-on-scroll">
                    <div class="flex items-center mb-4">
                        <div class="text-yellow-400">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                    <p class="text-gray-700 mb-4">"I love knowing exactly where my food comes from. The transparency and quality keep me coming back week after week."</p>
                    <div class="flex items-center">
                        <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Michael T." class="w-10 h-10 rounded-full mr-3">
                        <div>
                            <p class="font-medium">Michael T.</p>
                            <p class="text-sm text-gray-500">Verified Customer</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-green-50 p-6 rounded-lg fade-in-on-scroll">
                    <div class="flex items-center mb-4">
                        <div class="text-yellow-400">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                        </div>
                    </div>
                    <p class="text-gray-700 mb-4">"Their customer service is exceptional. Had an issue with a delivery and they resolved it immediately with a personal touch."</p>
                    <div class="flex items-center">
                        <img src="https://randomuser.me/api/portraits/women/68.jpg" alt="Emma L." class="w-10 h-10 rounded-full mr-3">
                        <div>
                            <p class="font-medium">Emma L.</p>
                            <p class="text-sm text-gray-500">Verified Customer</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Newsletter -->
    <section class="py-16 bg-green-800 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="md:flex items-center justify-between fade-in-on-scroll">
                <div class="md:w-1/2 mb-8 md:mb-0">
                    <h2 class="text-2xl font-bold mb-2">Join Our Community</h2>
                    <p class="text-green-200">Subscribe for seasonal recipes, farm updates, and exclusive offers on organic products.</p>
                </div>
                <div class="md:w-1/2">
                    <form class="flex">
                        <input type="email" placeholder="Your email address" class="flex-1 bg-green-700 text-white px-4 py-3 rounded-l-md focus:outline-none placeholder-green-300">
                        <button type="submit" class="bg-white text-green-800 px-6 py-3 rounded-r-md hover:bg-green-100 transition duration-300">Subscribe</button>
                    </form>
                    <p class="text-xs text-green-300 mt-2">We respect your privacy. Unsubscribe at any time.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-green-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <div class="fade-in-on-scroll">
                    <h3 class="text-lg font-medium mb-4">Shop</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-green-300 hover:text-white">All Products</a></li>
                        <li><a href="#" class="text-green-300 hover:text-white">New Arrivals</a></li>
                        <li><a href="#" class="text-green-300 hover:text-white">Best Sellers</a></li>
                        <li><a href="#" class="text-green-300 hover:text-white">Seasonal Specials</a></li>
                    </ul>
                </div>
                
                <div class="fade-in-on-scroll">
                    <h3 class="text-lg font-medium mb-4">About</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-green-300 hover:text-white">Our Story</a></li>
                        <li><a href="#" class="text-green-300 hover:text-white">Sustainability</a></li>
                        <li><a href="#" class="text-green-300 hover:text-white">Our Farmers</a></li>
                        <li><a href="#" class="text-green-300 hover:text-white">Press</a></li>
                    </ul>
                </div>
                
                <div class="fade-in-on-scroll">
                    <h3 class="text-lg font-medium mb-4">Customer Care</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-green-300 hover:text-white">Contact Us</a></li>
                        <li><a href="#" class="text-green-300 hover:text-white">FAQs</a></li>
                        <li><a href="#" class="text-green-300 hover:text-white">Delivery Info</a></li>
                        <li><a href="#" class="text-green-300 hover:text-white">Returns</a></li>
                    </ul>
                </div>
                
                <div class="fade-in-on-scroll">
                    <h3 class="text-lg font-medium mb-4">Connect</h3>
                    <div class="flex space-x-4 mb-4">
                        <a href="#" class="text-green-300 hover:text-white"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-green-300 hover:text-white"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-green-300 hover:text-white"><i class="fab fa-pinterest"></i></a>
                        <a href="#" class="text-green-300 hover:text-white"><i class="fab fa-youtube"></i></a>
                    </div>
                    <p class="text-green-300">123 Farm Lane<br>Green Valley, CA 90210</p>
                </div>
            </div>
            
            <div class="border-t border-green-800 mt-12 pt-8 flex flex-col md:flex-row justify-between items-center fade-in-on-scroll">
                <p class="text-green-400 text-sm mb-4 md:mb-0">Â© 2023 NATURE'S HARVEST. All rights reserved.</p>
                <div class="flex space-x-6">
                    <a href="#" class="text-green-400 hover:text-white text-sm">Privacy Policy</a>
                    <a href="#" class="text-green-400 hover:text-white text-sm">Terms of Service</a>
                    <a href="#" class="text-green-400 hover:text-white text-sm">Accessibility</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Shopping Cart Sidebar -->
    <div class="fixed inset-0 z-50 overflow-hidden" id="cart-sidebar">
        <div class="absolute inset-0 overflow-hidden">
            <div class="absolute inset-0 bg-gray-500 bg-opacity-75" id="cart-overlay"></div>
            <div class="fixed inset-y-0 right-0 max-w-full flex">
                <div class="w-screen max-w-md" id="cart-panel">
                    <div class="h-full flex flex-col bg-white shadow-xl">
                        <div class="flex-1 py-6 overflow-y-auto px-4 sm:px-6">
                            <div class="flex items-start justify-between">
                                <h2 class="text-lg font-medium text-gray-900">Your Basket</h2>
                                <button id="close-cart-btn" class="text-gray-400 hover:text-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 rounded-md">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div class="mt-8">
                                <div class="flow-root" id="cart-items-container">
                                    <!-- Cart items will be loaded here by JavaScript -->
                                    <p class="text-gray-500 text-center py-8">Your basket is empty</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 py-6 px-4 sm:px-6">
                            <div class="flex justify-between text-base font-medium text-gray-900 mb-4">
                                <p>Subtotal</p>
                                <p id="cart-subtotal">$0.00</p>
                            </div>
                            <p class="mt-0.5 text-sm text-gray-500 mb-6">Shipping calculated at checkout.</p>
                            <a href="checkout.html" id="checkout-button-link" class="block w-full bg-green-600 text-white py-3 rounded-md hover:bg-green-700 transition duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 text-center">
                                Checkout
                            </a>
                            <div class="mt-4 flex justify-center text-sm text-gray-500">
                            </a>
                            <div class="mt-4 flex justify-center text-sm text-gray-500">
                                <p>
                                    or <button id="continue-shopping-btn" class="text-indigo-600 hover:text-indigo-500 font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-150">Continue Shopping</button>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick View Modal -->
    <div class="fixed z-50 inset-0 overflow-y-auto hidden" id="quick-view-modal">
        <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 transition-opacity opacity-0" id="quick-view-overlay">
                <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
            </div>
            
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen">&#8203;</span>
            
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full opacity-0 scale-95">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <button id="close-quick-view-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-500">
                            <i class="fas fa-times"></i>
                        </button>
                        
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <div class="md:flex">
                                <div class="md:w-1/2 mb-6 md:mb-0">
                                    <img id="quick-view-image" src="" alt="Product" class="w-full rounded-lg">
                                </div>
                                <div class="md:w-1/2 md:pl-6">
                                    <h3 class="text-lg font-medium text-gray-900 mb-2" id="quick-view-title"></h3>
                                    <p class="text-gray-900 font-bold mb-4" id="quick-view-price"></p>
                                    <p class="text-gray-600 text-sm mb-4" id="quick-view-description"></p>
                                    
                                    <div class="mt-4">
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Size</label>
                                        <div id="quick-view-size-options" class="grid grid-cols-4 gap-2 mb-4">
                                            <!-- Sizes will be populated by JS -->
                                        </div>
                                        
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Color</label>
                                        <div id="quick-view-color-options" class="flex space-x-2 mb-6">
                                            <!-- Colors will be populated by JS -->
                                        </div>
                                        
                                        <div class="flex items-center mb-6">
                                            <button class="border border-gray-300 px-3 py-1 rounded-l" id="decrease-quantity-quick-view">-</button>
                                            <input type="text" value="1" class="w-12 text-center border-t border-b border-gray-300 py-1" id="quantity-input-quick-view" readonly>
                                            <button class="border border-gray-300 px-3 py-1 rounded-r" id="increase-quantity-quick-view">+</button>
                                        </div>
                                        
                                        <button class="w-full bg-black text-white py-3 rounded-md hover:bg-gray-800 transition duration-300 mb-4" id="add-to-cart-btn">
                                            Add to Cart
                                        </button>
                                        
                                        <button class="w-full border border-black text-black py-3 rounded-md hover:bg-gray-100 transition duration-300">
                                            Save for Later
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample product data
        const products = [ // Added availableSizes and availableColors to sample products
            {
                id: 1,
                title: "Classic White Tee",
                price: 39.99,
                image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=880&q=80",
                description: "Premium quality cotton t-shirt with a relaxed fit. Perfect for everyday wear.",
                category: "men",
                availableSizes: ["S", "M", "L", "XL"],
                availableColors: [{ name: "White", class: "bg-white" }, { name: "Black", class: "bg-black" }]
            },
            {
                id: 2,
                title: "Black Denim Jacket",
                price: 89.99,
                image: "https://images.unsplash.com/photo-1591047139829-d91aecb6caea?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=736&q=80",
                description: "Stylish black denim jacket with a classic fit. Features multiple pockets and premium hardware.",
                category: "men",
                availableSizes: ["M", "L"],
                availableColors: [{ name: "Black", class: "bg-black" }]
            },
            {
                id: 3,
                title: "Floral Summer Dress",
                price: 59.99,
                image: "https://images.unsplash.com/photo-1539109136881-3be0616acf4b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=687&q=80",
                description: "Lightweight floral dress perfect for summer days. Made from breathable fabric.",
                category: "women",
                availableSizes: ["S", "M", "L"],
                availableColors: [{ name: "Red", class: "bg-red-500" }, { name: "Blue", class: "bg-blue-500" }]
            },
            {
                id: 4,
                title: "Tailored Wool Blazer",
                price: 129.99,
                image: "https://images.unsplash.com/photo-1598033129183-c4f50c736ef7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1025&q=80",
                description: "Elegant wool blazer with a modern slim fit. Perfect for both office and evening wear.",
                category: "men",
                availableSizes: ["M", "L", "XL"],
                availableColors: [{ name: "Gray", class: "bg-gray-700" }, { name: "Navy", class: "bg-blue-800" }]
            },
            {
                id: 5,
                title: "High-Waisted Jeans",
                price: 69.99,
                image: "https://images.unsplash.com/photo-1541099649105-f69ad21f3246?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=687&q=80",
                description: "Comfortable high-waisted jeans with a flattering fit. Made from premium denim.",
                category: "women",
                availableSizes: ["26", "28", "30", "32"],
                availableColors: [{ name: "Blue", class: "bg-blue-600" }, { name: "Black", class: "bg-black" }]
            },
            {
                id: 6,
                title: "Cashmere Sweater",
                price: 99.99,
                image: "https://images.unsplash.com/photo-1551232864-3f0890e580d9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=687&q=80",
                description: "Luxurious cashmere sweater with a relaxed fit. Perfect for layering in cooler weather.",
                category: "women",
                // No options for this one, to test undefined handling
            },
            {
                id: 7,
                title: "Leather Crossbody Bag",
                price: 79.99,
                image: "https://images.unsplash.com/photo-1600086824259-7a0896e17558?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=687&q=80",
                description: "Stylish leather crossbody bag with multiple compartments. Fits all your essentials.",
                category: "accessories" 
                // No size/color options
            },
            {
                id: 8,
                title: "Linen Button-Up Shirt",
                price: 49.99,
                image: "https://images.unsplash.com/photo-1598033129183-c4f50c736ef7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1025&q=80",
                description: "Breathable linen shirt with a relaxed fit. Perfect for warm weather.",
                category: "men",
                availableSizes: ["S", "M", "L"],
                availableColors: [{ name: "White", class: "bg-white" }, { name: "Light Blue", class: "bg-blue-200" }]
            }
        ];

        // Shopping cart functionality
        let cart = [];
        try {
            const storedCart = localStorage.getItem('cart');
            if (storedCart) {
                cart = JSON.parse(storedCart);
            }
        } catch (e) {
            console.error("Error parsing cart from localStorage", e);
            cart = []; // Fallback to empty cart on error
        }
        
        // DOM elements
        const productsContainer = document.getElementById('products-container');
        const cartSidebar = document.getElementById('cart-sidebar');
        const cartOverlay = document.getElementById('cart-overlay');
        const cartBtn = document.getElementById('cart-btn');
        const closeCartBtn = document.getElementById('close-cart-btn');
        const continueShoppingBtn = document.getElementById('continue-shopping-btn');
        const cartItemsContainer = document.getElementById('cart-items-container');
        const cartSubtotal = document.getElementById('cart-subtotal');
        const cartCount = document.getElementById('cart-count');
        const quickViewModal = document.getElementById('quick-view-modal');
        const quickViewOverlay = document.getElementById('quick-view-overlay');
        const closeQuickViewBtn = document.getElementById('close-quick-view-btn');
        const quickViewImage = document.getElementById('quick-view-image');
        const quickViewTitle = document.getElementById('quick-view-title');
        const quickViewPrice = document.getElementById('quick-view-price');
        const quickViewDescription = document.getElementById('quick-view-description');
        const addToCartBtn = document.getElementById('add-to-cart-btn');
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        const searchBtn = document.getElementById('search-btn');
        const searchBar = document.getElementById('search-bar');
        
        // Display products
        function displayProducts() {
            productsContainer.innerHTML = '';
            
            products.forEach(product => {
                const productElement = document.createElement('div');
                productElement.className = 'group relative product-card';
                productElement.innerHTML = `
                    <div class="aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-gray-200 group"> <!-- Added group here for scale -->
                        <a href="product-detail.html?id=${product.id}">
                            <img src="${product.image}" alt="${product.title}" class="h-full w-full object-cover object-center group-hover:opacity-75 transition-transform duration-300 ease-in-out group-hover:scale-105">
                        </a>
                        <div class="product-overlay absolute inset-0 flex items-center justify-center opacity-0" data-id="${product.id}"> <!-- Added data-id here -->
                            <button class="bg-black text-white px-6 py-2 rounded-full text-sm font-medium hover:bg-gray-800 transition-colors duration-200 quick-view-btn-visual" data-id="${product.id}" tabindex="-1"> <!-- Changed class, made button non-focusable if overlay handles click -->
                                Quick View
                            </button>
                        </div>
                    </div>
                    <div class="mt-4 flex justify-between">
                        <div>
                            <h3 class="text-sm text-gray-700">
                                <a href="product-detail.html?id=${product.id}" class="font-medium">${product.title}</a>
                            </h3>
                            <p class="mt-1 text-sm text-gray-500">${product.category}</p>
                        </div>
                        <p class="text-sm font-medium text-gray-900">$${product.price.toFixed(2)}</p>
                    </div>
                    <button class="mt-2 w-full bg-gray-100 py-2 rounded-md text-sm font-medium hover:bg-gray-200 transition-colors duration-200 ease-in-out add-to-cart-btn" data-id="${product.id}">
                        Add to Cart
                    </button>
                `;
                
                productsContainer.appendChild(productElement);
            });
            
            // Add event listeners to quick view overlays
            document.querySelectorAll('.product-overlay').forEach(overlay => {
                overlay.addEventListener('click', (e) => {
                    // Prevent Quick View from triggering if the actual button inside (if it still exists and is clicked)
                    // or any other interactive element inside the overlay is clicked.
                    // For this case, the button is now purely visual or can be removed.
                    // If the click is on the button (e.target.closest('.quick-view-btn-visual')), 
                    // then currentTarget (the overlay) will still handle it.
                    const productId = parseInt(e.currentTarget.getAttribute('data-id'));
                    console.log("Product overlay clicked, productId from data-id:", e.currentTarget.getAttribute('data-id'), "Parsed productId:", productId); // New log
                    if (productId) { // This existing check is good, parseInt will yield NaN if attribute is not a number
                        openQuickView(productId);
                    } else {
                        console.error("Product overlay clicked, but failed to parse productId from data-id:", e.currentTarget.getAttribute('data-id'));
                    }
                });
            });
            
            // Add event listeners to add to cart buttons
            document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.getAttribute('data-id'));
                    addToCart(productId);
                });
            });
        }
        
        // Open quick view modal
        function openQuickView(productId) {
            if (typeof productId !== 'number' || productId <= 0) {
                console.error('openQuickView called with invalid productId:', productId);
                return;
            }
            console.log('openQuickView called with productId:', productId); // Added for positive confirmation
            const product = products.find(p => p.id === productId);
            if (product) {
                // Populate product details (this logic should be correct from original code)
                if (quickViewModal) quickViewModal.currentProduct = product; // Added null check
                if (quickViewImage) { // Added null check
                    quickViewImage.src = product.image;
                    quickViewImage.alt = product.title;
                }
                if (quickViewTitle) quickViewTitle.textContent = product.title; // Added null check
                if (quickViewPrice) quickViewPrice.textContent = `$${product.price.toFixed(2)}`; // Added null check
                if (quickViewDescription) quickViewDescription.textContent = product.description; // Added null check
                if (addToCartBtn) addToCartBtn.setAttribute('data-id', product.id); // Added null check

                const sizeOptionsContainer = document.getElementById('quick-view-size-options');
                const colorOptionsContainer = document.getElementById('quick-view-color-options');
                
                if (sizeOptionsContainer) {
                    sizeOptionsContainer.innerHTML = ''; // Clear previous options
                    if (product.availableSizes && product.availableSizes.length > 0) {
                        product.availableSizes.forEach((size, index) => {
                            const sizeButton = document.createElement('button');
                            sizeButton.className = `border border-gray-300 py-2 px-3 text-sm rounded hover:bg-gray-100 quick-view-size-btn ${index === 0 ? 'bg-black text-white' : ''}`;
                            sizeButton.dataset.size = size;
                            sizeButton.textContent = size;
                            sizeOptionsContainer.appendChild(sizeButton);
                            if (index === 0 && quickViewModal) quickViewModal.dataset.selectedSize = size;
                        });
                    } else {
                        sizeOptionsContainer.innerHTML = '<p class="text-sm text-gray-500 col-span-4">N/A</p>';
                        if (quickViewModal) delete quickViewModal.dataset.selectedSize;
                    }
                }


                if (colorOptionsContainer) {
                    colorOptionsContainer.innerHTML = ''; // Clear previous options
                    if (product.availableColors && product.availableColors.length > 0) {
                        product.availableColors.forEach((color, index) => {
                            const colorButton = document.createElement('button');
                            colorButton.className = `w-8 h-8 rounded-full border-2 hover:border-gray-400 focus:outline-none quick-view-color-btn ${color.class} ${index === 0 ? 'ring-2 ring-offset-1 ring-black' : 'border-gray-300'}`;
                            colorButton.dataset.colorName = color.name;
                            colorButton.title = color.name;
                            colorOptionsContainer.appendChild(colorButton);
                            if (index === 0 && quickViewModal) quickViewModal.dataset.selectedColor = color.name;
                        });
                    } else {
                        colorOptionsContainer.innerHTML = '<p class="text-sm text-gray-500">N/A</p>';
                        if (quickViewModal) delete quickViewModal.dataset.selectedColor;
                    }
                }
                
                if (typeof setupQuickViewOptionListeners === 'function') {
                    setupQuickViewOptionListeners(product);
                }
                const quantityInput = document.getElementById('quantity-input-quick-view');
                if (quantityInput) quantityInput.value = '1';
                
                // --- Animation Control ---
                if (quickViewModal) quickViewModal.classList.remove('hidden'); // 1. Unhide parent

                const modalBackdrop = document.getElementById('quick-view-overlay');
                // Use a more robust selector for the content panel, assuming it's a direct child of the flex container,
                // and the flex container is a direct child of quickViewModal
                const contentPanel = quickViewModal ? quickViewModal.querySelector('div > .inline-block.bg-white') : null;


                requestAnimationFrame(() => {
                    if (modalBackdrop) {
                        modalBackdrop.classList.remove('opacity-0');
                        modalBackdrop.classList.add('opacity-100');
                    }
                    if (contentPanel) {
                        contentPanel.classList.remove('opacity-0', 'scale-95');
                        contentPanel.classList.add('opacity-100', 'scale-100');
                    }
                });
                
                document.body.classList.add('overflow-hidden');
            }
        }
        
        // Close quick view modal
        function closeQuickView() {
            const modalBackdrop = document.getElementById('quick-view-overlay');
            const contentPanel = quickViewModal ? quickViewModal.querySelector('div > .inline-block.bg-white') : null;

            if (modalBackdrop) {
                modalBackdrop.classList.remove('opacity-100');
                modalBackdrop.classList.add('opacity-0');
            }
            if (contentPanel) {
                contentPanel.classList.remove('opacity-100', 'scale-100');
                contentPanel.classList.add('opacity-0', 'scale-95');
            }

            setTimeout(() => {
                if (quickViewModal) quickViewModal.classList.add('hidden');
                document.body.classList.remove('overflow-hidden');
            }, 300); // Adjust this duration to match your CSS transition duration (e.g., 150ms, 300ms)
        }
        
        // Add to cart
        function addToCart(productId, quantity = 1, selectedOptions = {}) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const sizeToStore = selectedOptions.size || null;
                const colorToStore = selectedOptions.color || null;

                const existingItem = cart.find(item => 
                    item.id === productId &&
                    item.selectedSize === sizeToStore &&
                    item.selectedColor === colorToStore
                );
                
                if (existingItem) {
                    existingItem.quantity += quantity;
                } else {
                    cart.push({
                        ...product,
                        quantity: quantity,
                        selectedSize: sizeToStore,
                        selectedColor: colorToStore
                    });
                }
                
                updateCart();
                
                // Show a quick notification
                const notification = document.createElement('div');
                notification.className = 'fixed bottom-4 right-4 bg-black text-white px-4 py-2 rounded-md shadow-lg';
                notification.textContent = 'Added to cart!';
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 2000);
            }
        }
        
        // Remove from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCart();
        }
        
        // Update cart quantity
        function updateCartItemQuantity(productId, newQuantity) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                if (newQuantity <= 0) {
                    removeFromCart(productId);
                } else {
                    item.quantity = newQuantity;
                }
                updateCart();
            }
        }
        
        // Update cart UI
        function updateCart() {
            // Update cart count
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            // Update cart items
            cartItemsContainer.innerHTML = '';
            const checkoutLink = document.getElementById('checkout-button-link');
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="text-gray-500 text-center py-8">Your cart is empty</p>';
                cartSubtotal.textContent = '$0.00';
                if (checkoutLink) {
                    checkoutLink.classList.add('opacity-50', 'cursor-not-allowed');
                    checkoutLink.setAttribute('aria-disabled', 'true');
                    checkoutLink.onclick = (e) => e.preventDefault(); 
                }
                localStorage.setItem('cart', JSON.stringify(cart)); // Save empty cart state
                return;
            }
            
            // If cart is NOT empty, ensure link is enabled
            if (checkoutLink) {
                checkoutLink.classList.remove('opacity-50', 'cursor-not-allowed');
                checkoutLink.removeAttribute('aria-disabled');
                checkoutLink.onclick = null; 
            }
            
            let subtotal = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;

                let optionsDisplay = '';
                if (item.selectedSize && item.selectedSize !== 'null' && item.selectedSize !== 'undefined') {
                    optionsDisplay += `<p class="mt-1 text-xs text-gray-500">Size: ${item.selectedSize}</p>`;
                }
                if (item.selectedColor && item.selectedColor !== 'null' && item.selectedColor !== 'undefined') {
                    optionsDisplay += `<p class="mt-1 text-xs text-gray-500">Color: ${item.selectedColor}</p>`;
                }
                
                const cartItem = document.createElement('div');
                cartItem.className = 'flex py-6 border-b border-gray-200';
                cartItem.innerHTML = `
                    <div class="h-24 w-24 flex-shrink-0 overflow-hidden rounded-md border border-gray-200">
                        <img src="${item.image}" alt="${item.title}" class="h-full w-full object-cover object-center">
                    </div>
                    <div class="ml-4 flex flex-1 flex-col">
                        <div>
                            <div class="flex justify-between text-base font-medium text-gray-900">
                                <h3>${item.title}</h3>
                                <p class="ml-4">$${itemTotal.toFixed(2)}</p>
                            </div>
                            <p class="mt-1 text-sm text-gray-500">${item.category}</p>
                            ${optionsDisplay} {/* Inserted options display here */}
                        </div>
                        <div class="flex flex-1 items-end justify-between text-sm">
                            <div class="flex items-center">
                                <button class="border border-gray-300 px-2 py-1 rounded-l decrease-quantity hover:bg-gray-100 active:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-indigo-500 transition-colors duration-150" data-id="${item.id}">-</button>
                                <span class="border-t border-b border-gray-300 px-3 py-1">${item.quantity}</span>
                                <button class="border border-gray-300 px-2 py-1 rounded-r increase-quantity hover:bg-gray-100 active:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-indigo-500 transition-colors duration-150" data-id="${item.id}">+</button>
                            </div>
                            <button type="button" class="font-medium text-red-600 hover:text-red-500 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-red-500 transition-colors duration-150 remove-item" data-id="${item.id}">
                                Remove
                            </button>
                        </div>
                    </div>
                `;
                
                cartItemsContainer.appendChild(cartItem);
            });
            
            // Update subtotal
            cartSubtotal.textContent = `$${subtotal.toFixed(2)}`;
            
            // Add event listeners to quantity buttons
            document.querySelectorAll('.decrease-quantity').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.getAttribute('data-id'));
                    const item = cart.find(item => item.id === productId);
                    if (item) {
                        updateCartItemQuantity(productId, item.quantity - 1);
                    }
                });
            });
            
            document.querySelectorAll('.increase-quantity').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.getAttribute('data-id'));
                    const item = cart.find(item => item.id === productId);
                    if (item) {
                        updateCartItemQuantity(productId, item.quantity + 1);
                    }
                });
            });
            
            // Add event listeners to remove buttons
            document.querySelectorAll('.remove-item').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = parseInt(e.target.getAttribute('data-id'));
                    removeFromCart(productId);
                });
            });
            localStorage.setItem('cart', JSON.stringify(cart)); // Save cart state
        }
        
        // Toggle cart sidebar
        function toggleCartSidebar() {
            const isOpen = cartSidebar.classList.contains('cart-sidebar-open');
            if (isOpen) {
                cartSidebar.classList.remove('cart-sidebar-open');
                document.body.classList.remove('overflow-hidden');
                // Add 'hidden' class after transition to remove from layout and a11y tree
                setTimeout(() => {
                    if (!cartSidebar.classList.contains('cart-sidebar-open')) { // Check again in case it was quickly reopened
                        cartSidebar.classList.add('hidden');
                    }
                }, 300); // Match transition duration
            } else {
                cartSidebar.classList.remove('hidden'); // Remove hidden before starting animation
                // Forcing a reflow can sometimes be necessary if adding/removing hidden and starting a transition immediately
                // but usually not an issue with opacity/transform if the element is already display:block.
                // void cartSidebar.offsetWidth; // Trigger reflow - might not be needed
                cartSidebar.classList.add('cart-sidebar-open');
                document.body.classList.add('overflow-hidden');
            }
        }
        
        // Toggle mobile menu
        function toggleMobileMenu() {
            const isOpen = mobileMenu.classList.contains('is-open');
            if (isOpen) {
                mobileMenu.classList.remove('is-open');
                setTimeout(() => {
                    if (!mobileMenu.classList.contains('is-open')) {
                         mobileMenu.classList.add('hidden');
                    }
                }, 300);
            } else {
                mobileMenu.classList.remove('hidden');
                // void mobileMenu.offsetWidth; // Trigger reflow if needed
                mobileMenu.classList.add('is-open');
            }
        }
        
        // Toggle search bar
        function toggleSearchBar() {
            const isOpen = searchBar.classList.contains('is-open');
            if (isOpen) {
                searchBar.classList.remove('is-open');
                setTimeout(() => {
                    if (!searchBar.classList.contains('is-open')) {
                        searchBar.classList.add('hidden');
                    }
                }, 300);
            } else {
                searchBar.classList.remove('hidden');
                // void searchBar.offsetWidth; // Trigger reflow if needed
                searchBar.classList.add('is-open');
            }
        }
        
        // Function to set up listeners for dynamically created size/color options in Quick View
        function setupQuickViewOptionListeners() {
            // Size option listeners
            document.querySelectorAll('.quick-view-size-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    document.querySelectorAll('.quick-view-size-btn').forEach(btn => {
                        btn.classList.remove('bg-black', 'text-white');
                        btn.classList.add('border-gray-300', 'hover:bg-gray-100');
                    });
                    e.currentTarget.classList.add('bg-black', 'text-white');
                    e.currentTarget.classList.remove('hover:bg-gray-100');
                    quickViewModal.dataset.selectedSize = e.currentTarget.dataset.size;
                });
            });

            // Color option listeners
            document.querySelectorAll('.quick-view-color-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    document.querySelectorAll('.quick-view-color-btn').forEach(btn => {
                        btn.classList.remove('ring-2', 'ring-offset-1', 'ring-black');
                        btn.classList.add('border-gray-300');
                    });
                    e.currentTarget.classList.add('ring-2', 'ring-offset-1', 'ring-black');
                    e.currentTarget.classList.remove('border-gray-300');
                    quickViewModal.dataset.selectedColor = e.currentTarget.dataset.colorName;
                });
            });
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            displayProducts();
            updateCart(); // Initialize cart display from localStorage
            // setupQuickViewOptionListeners(); // Removed redundant call, openQuickView will handle it.

            // Initially hide elements controlled by JS transitions
            if (!cartSidebar.classList.contains('cart-sidebar-open')) {
                cartSidebar.classList.add('hidden');
            }
            if (!mobileMenu.classList.contains('is-open')) {
                mobileMenu.classList.add('hidden');
            }
            if (!searchBar.classList.contains('is-open')) {
                searchBar.classList.add('hidden');
            }

            // Scroll-based animations
            const scrollElements = document.querySelectorAll('.fade-in-on-scroll');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target); // Animate only once
                    }
                });
            }, { threshold: 0.1 }); // Adjust threshold as needed

            scrollElements.forEach(el => {
                observer.observe(el);
            });
            
            // Cart functionality
            cartBtn.addEventListener('click', () => {
                console.log("Cart button clicked, should call toggleCartSidebar."); // For reasoning
                toggleCartSidebar();
            });
            closeCartBtn.addEventListener('click', toggleCartSidebar);
            continueShoppingBtn.addEventListener('click', toggleCartSidebar);
            cartOverlay.addEventListener('click', toggleCartSidebar);
            
            // Quick view functionality
            closeQuickViewBtn.addEventListener('click', closeQuickView);
            quickViewOverlay.addEventListener('click', closeQuickView);
            
            // Add to cart from quick view
            addToCartBtn.addEventListener('click', (e) => { // This is the #add-to-cart-btn in the modal
                const productId = parseInt(e.currentTarget.getAttribute('data-id'));
                const quantity = parseInt(document.getElementById('quantity-input-quick-view').value);
                
                const selectedSize = quickViewModal.dataset.selectedSize;
                const selectedColor = quickViewModal.dataset.selectedColor;

                // console.log("Adding to cart from QV:", productId, quantity, selectedSize, selectedColor); // Removed as per plan
                addToCart(productId, quantity, { size: selectedSize, color: selectedColor });
                closeQuickView();
            });
            
            // Quantity controls in quick view (using new IDs)
            document.getElementById('increase-quantity-quick-view').addEventListener('click', () => {
                const input = document.getElementById('quantity-input-quick-view');
                input.value = parseInt(input.value) + 1;
            });
            
            document.getElementById('decrease-quantity-quick-view').addEventListener('click', () => {
                const input = document.getElementById('quantity-input-quick-view');
                if (parseInt(input.value) > 1) {
                    input.value = parseInt(input.value) - 1;
                }
            });
            
            // Mobile menu
            mobileMenuBtn.addEventListener('click', toggleMobileMenu);
            
            // Search bar
            searchBtn.addEventListener('click', toggleSearchBar);
            
            // Smooth scrolling for navigation links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => { // This is fine as is
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                        
                        // Close mobile menu if open
                        if (!mobileMenu.classList.contains('hidden')) {
                            toggleMobileMenu();
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>
